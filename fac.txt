@clo
Feature: Deal Creation & Push

    Background:
        Given I am logged on the platform as a closer "PRE-CLOSING"
        When I create opportunity
            | confidentiality level | expected closing date | description               | name              | client    | Currency | deal amount    |
            | Confidential          | 2016-02-03            | This i s a selenium test  | e2e-closing-deal  | RENAULT   | EUR      | 500000         |
        And with deal team
            | Last Name | First Name | role        |
            | Kim       | Eric       | Deal Leader |
        And with deal details
            | business line leader  | sg role        |
            | MARK/FIC              | PARTICIPANT    |
        And with booking entity
            | name                   |
            | SOCIETE GENERALE/PARIS |
        And create deal
            | Syndication Type                | Financing purpose   | Counterpart   | Currency |
            | Syndicated Credit - Participant | Capital Raising     | DORNA SPORTS  | USD      |
        And create light facility without pricing
            | facility name | facility amount   |
            | Tranche A     | 50000             |
        And with mandated status

    Scenario: Push Contract
        Given the deal is in closing scope

        When with Agreement Date to yesterday
        And with Maximum number of Loans "2"
        And with Classification "Capital Financing"
        And with Mandatory MIS Codes
        And with Syndication MIS Codes
        And with Optional MIS Code "17-05-2016"
        And with Tracking Number
        And with Department "EU-MARK-CBA"
        And with Portfolio "CA100 | PORT.CREDITS ACHETEURS LOAN IQ"
        And with Alternate ID
        And with Agent "256"
        And with Deal manager "GAERTNER | LAURENCE | A130476"
        And with Closer team "TEAMCLOA"
        And with Deal Alias
        And push contract to Loan IQ

        Then the push should be successful


@fpl-lso
Feature: fpl-lso deal intialisation

  Background: 
    Given I am logged in as "Raj.FrontOfficer-MultiGroup"

  
  Scenario: deal initiation from fpl platform
    Given I am in fplportal page
    And the deal is being initiated with the below information
      | confidentiality level | Deal Name    | Description                         | Client        | SG Role Category | Deal Amount | Currency | Expected Closing Date |
      | Confidential          | Eligible Opp | Create an Opportunity For E2E tests | AIR CANADA 	 | Financing        | 10M         | USD      | 6M                    |
    And deal team and contacts are listed below with respective roles
      | Pierre PALMIERI   | Deal Leader   |
      | Andrew JOHNMAN    | Deal Member   |
      | Marina MULCAIR    | Other contact |
      | GLFI/ABP/CMBS/AME |               |
      | CORI/CLT/COR/AME  |               |
    When I create the deal
    Then I am able to start the structuring process for that deal

 
  Scenario: Syndicated Deal Structuring from the financing platform
    Given the deal is initiated in fpl
    And the deal is being structured with mandatory information
      | Syndication Type                              | Financing Purpose     | SG Roles | Business Line Leader |
      | Syndicated Credit - Arranger or mandated bank | Acquisition Financing | ARRANGER | GLFI/ABP/CMB         |
    When deal is saved
    Then I should get a notification saying "The deal was successfully saved."

 
  Scenario: Term Loan Facility creation
    Given the deal is structured
    And the below facility is being added to the deal
      | Facility Name      | Product Type | Product      | Structure | Liquidity Model | Description                     | Facility Amount | Currency | Final Take | Repayment Date | Forced Liquidity | Spread Field | paid by       |
      | Facility Term Loan | Loans        | Cash Advance | Term Loan | Aircraft        | Create a Facility For E2E tests | 3M              | USD      |         10 | 5Y             |               50 |          250 | AIRBUS FRANCE |
    When I price with facility
    And save the facility
    Then deal and facility should be saved with notification message "The deal was successfully saved."
